# FiguresApi
## Задание
Напишите приложение для работы с геометрическими фигурами, предоставляющее следующий API:
- метод /figure, который принимает POST-запрос с параметрами фигуры (предусмотреть круг и треугольник) и сохраняет ее в персистентное хранилище (по умолчанию SQLite, если хотите использовать другое решение, то необходимо предоставить Docker-контейнер с приложением и выбранной СУБД).
Сервис должен возвращать идентификатор фигуры.
- метод /figure/{id}, который по GET-запросу с идентификатором фигуры возвращает ее площадь, если фигура содержится в БД. 

Предложите контракты для сервисов, приведите пример корректного вызова (например, тело для POST-запроса) в readme.md.

Ожидаем увидеть в решении:
- Unit-тесты
- готовность сервисов к расширению (насколько сложно добавить поддержку нового типа фигур?)

Приложите ссылку на репозиторий с вашим решением (Github, GitLab). Приложение должно запускаться без дополнительной конфигурации или установки дополнительного ПО. 
	
При сомнениях делайте выбор в пользу самой простой, но соответствующей требованиям реализации. Принятые решения и допущения опишите в readme.md.

## Примеры
Для удобства коллекция вызовов POSTMAN находится в /Tools.

Сервис запускается по адресу:
https://localhost:44328

### Сохранение фигуры
```
POST /api/figure

BODY
{
    "type": "circle",
    "coordinates": [
        {
            "x": 10,
            "y": 20
        },
        {
            "x": 5,
            "y": 0
        }
    ]
}
!!! Вторая координата X = есть радиус круга.

BODY
{
    "type": "triangle",
    "coordinates": [
        {
            "x": 0,
            "y": 0
        },
        {
            "x": 5,
            "y": 0
        },
        {
            "x": 0,
            "y": 5
        }
    ]
}

RESPONSE EXAMPLE
5
```
### Рассчитать площадь фигуры
```
GET /api/figure/{id}

RESPONSE EXAMPLE
12
```

## От разработчика
Время работы ~ 11 часов.

Всё делал по официальным гайдам, что-то читал/изучал подробнее. С Entity Framework работал последний раз 5 лет назад, основной инструмент был NHibernate, с SQLite опыта не имел.

### Комментарии к работе
Какие-то доп. вещи требуют времени, решил оставить проект компактным и не заниматься over-engineering.
Готов показать доработки при необходимости. Ниже некие пояснения:
- Проект можно было начать на .Net Core 5, а не .Net Core 3.1, фреймворк нужный не стоял, но могу поднять версию;
- Можно разделить решение на слои-отдельные проекты:
  - Чисто Web API - без бизнес логики и доступа напрямую к слою данных;
  - Бизнес-сервисы (правила) - не зависят от АПИ и реализации БД, слой между контроллерами и БД;
  - Выделить отдельно репозитории или DAL для доступа к данным;
  - Каждый слой можно разделить между собой интерфейсами и контрактами.
- АПИ шные контракты фигуры можно сделать по-разному. Ещё варианты:
  - Круг нетиповая фигура, я сделал так, что вторая координата.X есть радиус, но это довольно специфично и завязано на порядок.
  - Можно было бы добавить необязательное поле Радиус, но оно немного будет выпадать из других фигур.
  - Можно было бы сделать отдельный объект или массив Параметры, чтобы была некая универсальность для разных типов фигур.
- Тип фигуры я передаю строкой, но можно было сделать Enum или конвертить внутри в Enum для доменной или БД модели.
- В АПИ я проверяю данные при сохранении, валидацию можно было бы расширить, к примеру, проверять, что не одинаковые координаты присылают. Также можно было бы разработать формат ошибок для АПИ: к примеру, при ошибках выдавать объект, где будет код ошибки и некий message.
- Для вычислений использовал тип double, решил, что достаточная точность. Decimal, думаю, уже перебор.
- Можно было бы внимательнее изучить как EF создает SQLite БД по модели, возможно, стоит как-то точнее задавать типы.
- Можно координаты было бы хранить не в отдельной таблице, а как сериализованный объект в таблице фигур, к примеру, чтобы не JOIN-ить данные, а сразу читать вместе с фигурой. Но из явных минусов на будущее, нельзя будет строить фильтры по координатам в запросах к БД.
- Я сделал в лоб создание БД по модели при старте сервиса, можно прикрутить механизм миграций изменений схемы БД.
- Стоит позакрывать у моделей сеттеры и вынести по максимуму всё в конструктор, чтобы нельзя было менять состояние объектов.
- Можно расширить АПИ: добавить получение всех фигур, удаление, можно добавить AdminController для пересоздания БД, чтобы удобнее было тестить, к примеру.
- Почитал как пишут Unit-ы для EF Core, общая рекомендация использовать или In-Memory реализацию или реальную, но тестовую БД. Собственно, и создаю тестовую SQLite Db.
- Можно было бы в целом, написать больше тестов, на всякие доп. сценарии, когда данные не найдены, к примеру. Можно было бы пройтись Code Coverage и добиться какого-нибудь внушительного процента.
- Можно было бы по коду расставить аннотации NotNull, Null на вход, выход функций или реальные проверки повесить на null.
